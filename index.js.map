{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = \"51385266-59a206174458b904205f7b7fa\";\n\nexport async function getImagesByQuery(query, page = 1) {\n  try {\n    const response = await axios('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page,\n      }\n    });\n    return response.data\n  } catch (error) {\n    console.log(error.message);\n  }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox = null;\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loaderContainer = document.querySelector(\".loader-container\");\nconst loaderMore = document.querySelector(\".loader-more\")\nconst loaderMoreContainer = document.querySelector(\".loader-more-container\");\nconst btnLoadMore = document.querySelector(\".btn-load-more\");\n\nexport function createMarkup(arr) {\n  return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n      <div class=\"wrap\">\n        <a class=\"gallery-item\" href=\"${largeImageURL}\">\n          <img class=\"img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360px\">\n        </a>\n        <ul class=\"list\">\n          <li class=\"list-item\"><p class=\"label\">Likes</p><p class=\"value\">${likes}</p></li>\n          <li class=\"list-item\"><p class=\"label\">Views</p><p class=\"value\">${views}</p></li>\n          <li class=\"list-item\"><p class=\"label\">Comments</p><p class=\"value\">${comments}</p></li>\n          <li class=\"list-item\"><p class=\"label\">Downloads</p><p class=\"value\">${downloads}</p></li>\n        </ul>\n      </div>\n    `;\n  }).join(\"\");\n}\n\nexport function renderGallery(images, append = false) {\n  const markup = createMarkup(images);\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', markup);\n  } else {\n    gallery.innerHTML = markup;\n  }\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n  loader.classList.remove(\"hidden\");\n  loaderContainer.style.display = 'flex';\n\n}\n\nexport function hideLoader() {\n  loader.classList.add(\"hidden\");\n  loaderContainer.style.display = 'none';\n\n}\n\n\nexport function showLoaderMore() {\n  loaderMore.classList.remove(\"hidden\");\n  loaderMoreContainer.style.display = 'flex';\n\n}\n\nexport function hideLoaderMore() {\n  loaderMore.classList.add(\"hidden\");\n  loaderMoreContainer.style.display = 'none';\n}\n\n\n\nexport function showLoadMoreButton() {\n  btnLoadMore.classList.remove(\"hidden\");\n  \n}\n\nexport function hideLoadMoreButton() {\n  btnLoadMore.classList.add(\"hidden\");\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  renderGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  hideLoaderMore,\n  showLoaderMore\n} from './js/render-functions';\n\nconst form = document.querySelector(\".form\");\nconst loadMoreBtn = document.querySelector(\".btn-load-more\");\n\nform.addEventListener(\"submit\", handleSubmit);\nloadMoreBtn.addEventListener(\"click\", onLoadMore);\n\nlet page = 1;\nlet userInput = '';\nlet totalHitsAvailable = 0;\n\n\n\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  userInput = event.target.elements[\"search-text\"].value.trim();\n  page = 1;\n  \n\n  if (userInput === \"\") {\n    iziToast.warning({\n      message: 'Unfortunately you cannot leave the input blank',\n      position: 'topRight',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      color: '#ef4040',\n      iconUrl: './img/bi_x-octagon-2.svg',\n      maxWidth: 432\n    });\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n\n  try {\n    const res = await getImagesByQuery(userInput);\n    \n    totalHitsAvailable = res.totalHits;\n\n    if (!res.hits || res.hits.length === 0) {\n      iziToast.show({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        messageColor: '#fff',\n        titleColor: '#fff',\n        color: '#ef4040',\n        iconUrl: './img/bi_x-octagon-2.svg',\n        maxWidth: 432\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    renderGallery(res.hits);\n    showLoadMoreButton();\n    form.reset();\n  } catch (error) {\n    iziToast.show({\n      message: 'Sorry, something went wrong. Please try again!',\n      position: 'topRight',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      color: '#ef4040',\n      iconUrl: './img/bi_x-octagon-2.svg',\n      maxWidth: 432\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  page++\n  hideLoadMoreButton();\n  showLoaderMore();\n  const IMAGES_PER_PAGE = 15;\nconst maxPage = Math.ceil(totalHitsAvailable / IMAGES_PER_PAGE);\n  try {\n    if (page > maxPage) {\n      iziToast.show({\n      message: 'We are sorry, but you haveve reached the end of search results.',\n      position: 'topRight',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      color: '#ef4040',\n      iconUrl: './img/bi_x-octagon-2.svg',\n      maxWidth: 432\n      });\n      hideLoadMoreButton();\n      return\n    }\n    const data = await getImagesByQuery(userInput, page);\n    renderGallery(data.hits, true);\n    const div = document.querySelector(\".wrap\");\n    const divHeight = div.getBoundingClientRect().height;\n    window.scrollBy({\n      top: divHeight * 6,\n      behavior: \"smooth\"\n    });\n    showLoadMoreButton();\n    \n  } catch (error) {\n    alert(error.message)\n  } finally {\n    hideLoaderMore();\n  }\n}\n\n"],"names":["API_KEY","getImagesByQuery","query","page","axios","error","lightbox","gallery","loader","loaderContainer","loaderMore","loaderMoreContainer","btnLoadMore","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","images","append","markup","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoaderMore","hideLoaderMore","showLoadMoreButton","hideLoadMoreButton","form","loadMoreBtn","handleSubmit","onLoadMore","userInput","totalHitsAvailable","event","iziToast","res","maxPage","data","divHeight"],"mappings":"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"}